{% extends 'base.html' %}
{% block content %}
{% load static %}

<br>
<!--<h2> ... </h2>-->
<br>
{% if user.is_authenticated %}
  <a class="btn btn-primary btn-success" href="{% url 'interests:create' %}"><span class="glyphicon glyphicon-plus"></span> Create Interest</a>
  <!-- <button  type="button">Open Overlay</button> -->
  <br><br>
  {% for u_interest in user.profile.interests.all %}

    {% if u_interest.creator == request.user %}
      {{ u_interest }}
      <a class="refresh-button" onClick="document.getElementById('refresh-form').submit()" title="Update results" id="trigger-overlay">
        <span class="glyphicon glyphicon-refresh"></span>
      </a>
      <form id="refresh-form" method="POST" action="{% url 'interests:refresh' u_interest.id %}">
        {% csrf_token %}
        <input type="hidden" value="refresh">
      </form>
      <h6>
        <span class="text-muted">
          <span class="glyphicon glyphicon-time"></span>
          Updated on {{ u_interest.last_refreshed }}
        </span>
      </h6>
      {% if u_interest.newsresults.newsitems.all %}
        {% for r in u_interest.newsresults.newsitems.all %}<br>
          <a href={{r.link}}>{{ r }}</a>
        {% endfor %}
      {% else %}
        <i>No results found</i> <br>
      {% endif %}
    {% endif %}
    <hr>
  {% endfor %}

{% else %}
  <div class="jumbotron">
  <h2>Say: Your Truthful News Fetcher</h2>
  <br>
  <p class="jumbo">In today's politics, it can sometimes be hard to know if the news you're reading is reliable.
  That's where Say comes in! Create an Interest with a few related keywords of what you're
  'interested' in, and you'll get back news articles from reputable and respected sources! No sifting, wading, or
  searching necessary.</p>
  <br>
  <p><a class="btn btn-primary btn-lg" href="{% url 'accounts:register' %}" role="button">Get Started!</a></p>
  </div>
{% endif %}

<div class="overlay overlay-scale">
  <div class="panel panel-info centered" style="width:50%;">
    <div class="panel-heading">
      <h4>
        <center>Fetching Knowledge...</center>
      </h4>
    </div>
    <div class="panel-body">
      <div class="progress progress-striped active">
        <div class="progress-bar" style="width: 100%"></div>
      </div>
    </div>
  </div>
</div>
<script src="{% static 'accounts/classie.js' %}" type="text/javascript"></script>
<script src="{% static 'accounts/modernizr.custom.js' %}" type="text/javascript"></script>
<script src="{% static 'accounts/demo1.js' %}" type="text/javascript"></script>

{% endblock %}
